import r from"crypto-js";let{stringify:t}=JSON,sha256=r.SHA256;class PasswordHasher{constructor(r){if(this.layers=r,"number"!=typeof r)throw Error("password layers need to be a number");if(r<1)throw Error("layers must be atleast 1")}hash(r){return new Promise((t,e)=>{var s=r;let a=this.layers;try{for(var h=0;h<=a;h++)if(h<a){let o=sha256(s);s=o.toString()}else{let l=sha256(s),n=l.toString();t(n)}}catch(c){e(c)}})}compare(r,t){return new Promise((e,s)=>{this.hash(r).then(r=>{e(r===t)}).catch(r=>s(r))})}}export default PasswordHasher;
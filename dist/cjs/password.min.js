"use strict";var __importDefault=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});const crypto_js_1=__importDefault(require("crypto-js")),{stringify:t}=JSON,sha256=crypto_js_1.default.SHA256;class PasswordHasher{constructor(t){if(this.layers=t,"number"!=typeof t)throw Error("password layers need to be a number");if(t<1)throw Error("layers must be atleast 1")}hash(t){return new Promise((e,r)=>{var s=t;let a=this.layers;try{for(var o=0;o<=a;o++)if(o<a){let h=sha256(s);s=h.toString()}else{let l=sha256(s),u=l.toString();e(u)}}catch(i){r(i)}})}compare(t,e){return new Promise((r,s)=>{this.hash(t).then(t=>{r(t===e)}).catch(t=>s(t))})}}module.exports=PasswordHasher;